<!DOCTYPE html>
<html lang="zh-CN" >
<head>
<meta charset="UTF-8" />
<title>è‚‰æ¾å¤§ç‹ç¾Šæ¯›é£æ§å€¼æ£€æµ‹</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<!-- ç«™é…·å¿«ä¹ä½“ å›½å†…å¯è®¿é—® -->
<link href="https://fonts.font.im/css?family=ZCOOL+KuaiLe" rel="stylesheet" />
<style>
  /* Reset */
  * {margin:0;padding:0;box-sizing:border-box;}
  body {
    font-family: 'ZCOOL KuaiLe', "å¾®è½¯é›…é»‘", Arial, sans-serif;
    background: linear-gradient(135deg, #ffefa1 0%, #ffb347 70%);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: #663300;
    text-align: center;
    padding: 40px 16px;
    overflow-x: hidden;
  }
  h1 {
    font-size: 2.8rem;
    font-weight: 900;
    color: #cc6600;
    text-shadow:
      2px 2px 6px #ffca76,
      0 0 10px #ffb347;
    margin-bottom: 32px;
    user-select: none;
  }
  .card {
    background: rgba(255, 255, 255, 0.92);
    border-radius: 20px;
    box-shadow:
      0 10px 30px rgba(255, 155, 0, 0.35),
      inset 0 0 20px #ffcc7a;
    margin-bottom: 28px;
    padding: 24px 32px;
    max-width: 380px;
    font-size: 1.3rem;
    font-weight: 700;
    user-select: text;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 60px;
    transition: box-shadow 0.4s ease;
  }
  #riskBox {
    color: #b35100;
  }
  #riskValue {
    font-weight: 900;
    color: #ff7600;
    margin-left: 8px;
  }
  .loading {
    font-size: 1.25rem;
    font-style: italic;
    font-weight: 700;
    color: #d95c00;
    letter-spacing: 5px;
    margin-bottom: 48px;
    animation: blink 1.2s infinite;
    user-select: none;
    -webkit-user-select:none;
  }
  #dots {
    font-weight: 900;
    color: #e06e00;
  }
  @keyframes blink {
    0%,50%,100% {opacity:1;}
    25%,75% {opacity:0.3;}
  }
  /* åŠ¨ç”»ç¥è´ºæ–‡å­— */
  .congrats {
    display: none;
    font-family: 'ZCOOL KuaiLe', cursive, Arial, sans-serif;
    font-size: 1.95rem;
    color: #f9b800;
    text-shadow:
      3px 6px 30px #7a5600,
      0 0 45px #fff38f;
    max-width: 380px;
    margin: 0 auto;
    user-select: none;
    -webkit-user-select:none;
    text-align: center;
    padding: 18px 24px;
    animation: tada 1.6s ease forwards;
  }
  .congrats .emoji {
    font-size: 4.5rem;
    margin-right: 0.5em;
    filter: drop-shadow(0 0 24px #ffd900);
    display: inline-block;
    animation: crown-bounce 1.8s infinite;
    vertical-align: middle;
  }
  @keyframes crown-bounce {
    0%,100% {transform: translateY(0) rotate(-10deg);}
    50% {transform: translateY(-25px) rotate(16deg);}
  }
  @keyframes tada {
    0% {transform: scale(1);}
    15% {transform: scale(1.3) rotate(-7deg);}
    30% {transform: scale(0.9) rotate(7deg);}
    45% {transform: scale(1.12) rotate(0);}
    60% {transform: scale(1);}
    100% {transform: scale(1);}
  }
  /* æ‰‹æœºç«¯é€‚é… */
  @media (max-width: 480px) {
    h1 {
      font-size: 2rem;
    }
    .card {
      font-size: 1.05rem;
      max-width: 90vw;
      padding: 20px 18px;
      min-height: 54px;
      margin-bottom: 22px;
    }
    .loading {
      font-size: 1rem;
      letter-spacing: 3px;
      margin-bottom: 36px;
    }
    .congrats {
      font-size: 1.3rem;
      padding: 14px 18px;
    }
    .congrats .emoji {
      font-size: 3rem;
      margin-right: 0.3em;
    }
  }
</style>
</head>
<body>
  <h1>è‚‰æ¾å¤§ç‹ç¾Šæ¯›é£æ§å€¼æ£€æµ‹</h1>
  <section id="ipBox" class="card" aria-live="polite" aria-label="å½“å‰IPåœ°å€">è·å–IPä¸­...</section>
  <section id="locationBox" class="card" aria-live="polite" aria-label="å½’å±åœ°ä¿¡æ¯">å®šä½ä¸­...</section>
  <div class="loading" id="loadingText" aria-live="polite" aria-label="æ£€æµ‹è¿›åº¦æç¤º">
    æ­£åœ¨æ£€æµ‹ä¸­<span id="dots">...</span>
  </div>
  <section id="riskBox" class="card" aria-live="polite" aria-label="é£æ§ç­‰çº§" style="display:none;">
    é£æ§ç­‰çº§ï¼š
    <span id="riskValue">ä½å±</span>
  </section>
  <section class="congrats" id="congratsBox" role="alert" aria-live="assertive">
    <span class="emoji">ğŸ¥³</span>è‚‰æ¾å¤§ç‹æ­å–œæ‚¨çš„IPä¸€ç‚¹æ¯›ç—…æ²¡æœ‰ï¼
  </section>

<script>
  // åŠ¨æ€ç‚¹ç‚¹ç‚¹åŠ¨ç”»
  function animateDots() {
    const dots = document.getElementById('dots');
    let count = 0;
    return setInterval(() => {
      count = (count + 1) % 4;
      dots.textContent = '.'.repeat(count);
    }, 600);
  }

  // è·å–å…¬ç½‘IP
  async function fetchIP() {
    try {
      const res = await fetch('https://api64.ipify.org?format=json');
      if (!res.ok) throw new Error('ç½‘ç»œå¼‚å¸¸');
      const data = await res.json();
      return data.ip || null;
    } catch {
      return null;
    }
  }

  // å½’å±åœ°æŸ¥è¯¢ï¼ˆç”¨ip-api.comï¼Œjsonpè·¨åŸŸï¼‰
  function fetchLocation(ip) {
    return new Promise((resolve) => {
      const callbackName = 'ipApiCallback_' + Math.floor(Math.random() * 1e9);
      window[callbackName] = function(data) {
        delete window[callbackName];
        document.body.removeChild(script);
        if (data && data.status === 'success') {
          resolve(data);
        } else {
          resolve(null);
        }
      };
      const script = document.createElement('script');
      script.src = `http://ip-api.com/json/${ip}?callback=${callbackName}`;
      document.body.appendChild(script);
    });
  }

  async function runDetection() {
    const ipBox = document.getElementById('ipBox');
    const locationBox = document.getElementById('locationBox');
    const riskBox = document.getElementById('riskBox');
    const loadingText = document.getElementById('loadingText');
    const congratsBox = document.getElementById('congratsBox');

    const dotsInterval = animateDots();

    ipBox.textContent = 'è·å–IPä¸­...';
    locationBox.textContent = 'å®šä½ä¸­...';

    const ip = await fetchIP();
    if (!ip) {
      ipBox.textContent = 'æ— æ³•è·å–IP ğŸ˜¢';
      locationBox.textContent = '';
      loadingText.style.display = 'none';
      return;
    }
    ipBox.textContent = `å½“å‰IPåœ°å€ï¼š${ip}`;

    const locationData = await fetchLocation(ip);
    if (locationData) {
      locationBox.textContent = `å½’å±åœ°ï¼š${locationData.country} Â· ${locationData.regionName} Â· ${locationData.city}`;
    } else {
      locationBox.textContent = 'å½’å±åœ°æŸ¥è¯¢å¤±è´¥';
    }

    // æ¨¡æ‹Ÿæ£€æµ‹å»¶è¿Ÿï¼Œä¿æŒç‚¹ç‚¹åŠ¨ç”»3ç§’å·¦å³
    setTimeout(() => {
      clearInterval(dotsInterval);
      loadingText.style.display = 'none';
      riskBox.style.display = 'flex';
      riskBox.querySelector('#riskValue').textContent = 'ä½å±';

      // ç¥è´ºåŠ¨ç”»å»¶æ—¶å±•ç¤º
      setTimeout(() => {
        congratsBox.style.display = 'block';
      }, 700);
    }, 3200);
  }

  runDetection();
</script>
</body>
</html>
